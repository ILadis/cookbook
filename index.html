<!DOCTYPE html>
<html lang="de">
<head>
  <title>Kochbuch</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#f9f8f5">
  <link href="./assets/favicon.ico" rel="icon">
  <link href="./assets/styles.css" rel="stylesheet">
  <link href="./assets/manifest.webmanifest" rel="manifest">
  <script type="module">
  import { Router } from './app/router.js';
  import { Presenter } from './app/presenter.js';

  const router = new Router();
  const presenter = new Presenter();

  let index = router.register('list', [], () =>
    presenter.showIndex());

  presenter.onIndexShown = () =>
    router.navigateTo(index);

  let create = router.register('new', [], () =>
    presenter.showForm());

  let edit = router.register('edit', ['id'], ({ id }) =>
    presenter.showForm(id));

  presenter.onFormShown = ({ id }) =>
    router.navigateTo(id ? edit : create, { id });

  let recipe = router.register('recipe', ['id'], ({ id }) =>
    presenter.showRecipe(id));

  presenter.onRecipeShown = async ({ id }) => {
    if (router.referFrom(create, edit)) {
      await router.gobackTo(index);
    }
    router.navigateTo(recipe, { id });
  };

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./service-worker.js');
  }

  window.onhashchange =
  window.onload = () => {
    let route = router.apply(location.hash);

    if (!route) {
      presenter.showIndex();
    }
  };

  document.onselectstart = () => false;
  </script>
</head>
<body>
</body>
</html>

