<!DOCTYPE html>
<html lang="de">
<head>
  <title>Kochbuch</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#f9f8f5">
  <link href="./assets/favicon.ico" rel="icon">
  <link href="./assets/styles.css" rel="stylesheet">
  <link href="./assets/manifest.webmanifest" rel="manifest">
  <script type="module">
  import { Router } from './app/router.js';
  import { Presenter } from './app/presenter.js';

  const router = new Router();
  const presenter = new Presenter();

  let index = router.register('list', [], () =>
    presenter.showIndex());

  presenter.indexShown = () =>
    router.navigateTo(index);

  let create = router.register('new', [], () =>
    presenter.showForm());

  presenter.formShown = () =>
    router.navigateTo(create);

  let recipe = router.register('recipe', ['alias'], ({ alias }) =>
    presenter.showRecipe(alias));

  presenter.recipeShown = ({ alias }) =>
    router.navigateTo(recipe, { alias });

  router.navigateTo = function(route, values) {
    if (this.active != route) {
      let hash = route.compute(values);
      let uri = location.pathname + hash;
      history.pushState(null, '', uri);
    }
  };

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./service-worker.js');
  }

  window.onhashchange =
  window.onload = () => {
    let route = router.apply(location);

    if (!route) {
      presenter.showIndex();
    }
  };

  document.onselectstart = () => false;
  </script>
</head>
<body>
</body>
</html>

